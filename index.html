<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Anonimler</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" href="/assets/icon.png" />
</head>
<body>
  <header>
    <img src="/assets/icon.png" alt="Icon" class="icon" />
    <h1 class="blog-title">Anonimler</h1>
    <nav class="menu">
      <a href="#" onclick="navigateTo('about')">Hakkımızda</a>
      <a href="#" onclick="navigateTo('disclaimer')">Sorumluluk Reddi</a>
    </nav>
  </header>
  <h3>Gizli, Özgür, Ücretsiz bir internet için Türkçe rehber</h3>
  <main id="posts">
    <div id="blog-list"></div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script>
    // Tüm blogları yükle
    document.addEventListener('DOMContentLoaded', function() {
      fetchBlogPosts();
    });

    async function fetchBlogPosts() {
      try {
        // GitHub Pages için posts klasöründeki dosyaları al
        const response = await fetch('posts/list.json'); // Önce list.json oluşturmalısınız
        const posts = await response.json();
        
        let html = '<h2>Blog Yazıları</h2><ul class="post-list">';
        posts.forEach(post => {
          html += `
            <li>
              <a href="#" onclick="loadPost('${post.file}')">${post.title}</a>
              <small>${post.date}</small>
            </li>
          `;
        });
        html += '</ul>';
        
        document.getElementById('blog-list').innerHTML = html;
      } catch (error) {
        console.error('Blog yazıları yüklenirken hata oluştu:', error);
        document.getElementById('blog-list').innerHTML = '<p>Blog yazıları yüklenirken bir hata oluştu.</p>';
      }
    }

    function loadPost(postFile) {
      fetch(`posts/${postFile}`)
        .then(res => res.text())
        .then(text => {
          document.getElementById('blog-list').innerHTML = `
            <article class='blog-post'>
              ${marked.parse(text)}
            </article>
            <button onclick="fetchBlogPosts()">Geri</button>
          `;
        })
        .catch(err => {
          console.error('Yazı yüklenirken hata:', err);
          document.getElementById('blog-list').innerHTML = '<p>Yazı yüklenirken bir hata oluştu.</p>';
        });
    }

    function navigateTo(page) {
      fetch(`posts/${page}.md`)
        .then(res => res.text())
        .then(text => {
          document.getElementById('blog-list').innerHTML = `
            <article class='static-page'>
              ${marked.parse(text)}
            </article>
            <button onclick="fetchBlogPosts()">Geri</button>
          `;
        });
    }
  </script>
</body>
</html>
